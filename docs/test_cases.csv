ID,Escenario,Pre-condiciones,Pasos,Resultado Esperado,Prioridad,Datos de Prueba
TP-01,Path feliz: cliente con buen historial,"Cliente en BD: id=1001; score_cifin=750; estado=activo","POST /api/bureau/consultar {cliente_id:1001}",200 OK; score=750; tiene_historial=true; puntualidad=Buena,Alta,"cliente_id=1001"
TP-02,Cliente con deudas activas,"Cliente en BD: id=1002; score_cifin=680","POST /api/bureau/consultar {cliente_id:1002}",200 OK; deudas_activas>0; monto_deudas>0,Alta,"cliente_id=1002"
TP-03,Cliente en lista de riesgo CIFIN,"Cliente en BD: id=1003; estado=bloqueado","POST /api/bureau/consultar {cliente_id:1003}",403 Forbidden; detalle 'Consulta bloqueada',Crítica,"cliente_id=1003"
TP-04,Validación: documento inválido,"Ninguna","POST /api/bureau/consultar {cliente_id:'ABC123'}",422 Unprocessable Entity; error de validación,Media,"payload={'cliente_id':'ABC123'}"
TP-05,Manejo error: servicio externo caído,"Simular caída del servicio externo","POST /api/bureau/consultar {cliente_id:1010}",502/503; mensaje claro 'Servicio de bureau no disponible',Crítica,"cliente_id=1010 (simular caída)"
TP-06,Manejo timeout 5s,"Simular latencia >5s en integración","POST /api/bureau/consultar {cliente_id:1011}",504 Gateway Timeout o manejo equivalente,Alta,"cliente_id=1011 (simular latencia)"
TP-07,Respuesta inválida del servicio externo,"Integración devuelve JSON malformado","POST /api/bureau/consultar {cliente_id:1012}",500/502; API maneja y devuelve error manejable,Alta,"cliente_id=1012 (simular payload inválido)"
TP-08,Documento duplicado (edge),"DB con duplicidad de identificación (simular)","Flujo que provoque búsqueda por identificación duplicada",409 Conflict o 400 con mensaje; no devolver datos sensibles,Baja,"identificacion=80012345 (duplicada)"
TP-09,Cliente extranjero,"Cliente en BD: id=2001; identificacion='EXT-999'; score_cifin=NULL","POST /api/bureau/consultar {cliente_id:2001}",200 OK; score=0; tiene_historial=false; mensaje sugiere verificación adicional,Media,"cliente_id=2001; identificacion=EXT-999"
TP-10,Sin historial (cliente nuevo),"Cliente en BD: id=1004; score_cifin=NULL","POST /api/bureau/consultar {cliente_id:1004}",200 OK; score=0; tiene_historial=false; mensaje 'Sin historial',Media,"cliente_id=1004"
TP-11,GET última consulta existente,"Existe consulta mock para cliente id=1","GET /api/bureau/1",200 OK; BureauResponse con cliente_id=1,Baja,"cliente_id=1"
TP-12,GET última consulta no existente,"No existe cliente id=9999","GET /api/bureau/9999",404 Not Found con detalle 'Cliente no encontrado',Alta,"cliente_id=9999"
TP-13,Límite consultas (>1 en 24h),"Cliente id=1005 consultado en últimas 24h","POST /api/bureau/consultar {cliente_id:1005}",429 Too Many Requests; mensaje 'Límite de consultas',Alta,"cliente_id=1005 (marcar como ya consultado)"
TP-14,Input boundary: cliente_id negativo,"Ninguna","POST /api/bureau/consultar {cliente_id:-1}",400/422; validación o 'Cliente no encontrado',Baja,"cliente_id=-1"
TP-15,Payload incompleto (campo requerido faltante),"Ninguna","POST /api/bureau/consultar {}",422 Unprocessable Entity; error por campo requerido,Media,"payload={}"
TP-16,Performance: latencia individual aceptable,"Cliente id=1001 preparado","POST /api/bureau/consultar {cliente_id:1001}",200 OK; tiempo de respuesta < 200ms,Alta,"cliente_id=1001; threshold_ms=200"
TP-17,Performance: concurrencia sostenida 50 usuarios,"Clientes preparados varios ids (1001..1050)","50 concurrent POST requests to /api/bureau/consultar","95th percentile latency < 500ms; error rate < 1%",Crítica,"concurrency=50; duration=30s; ids range"
TP-18,Performance: pico de tráfico (spike),"Servidor monitoreado","Burst 200 requests en 10s","Sistema se mantiene estable; error rate < 5%; degradación graceful",Alta,"spike=200 in 10s"
TP-19,Performance: throughput sostenido,"Carga sostenida 10 req/s por 5min","POSTs continuos","Throughput >=10 req/s; median latency aceptable (<300ms)",Media,"rate=10/s; duration=300s"
TP-20,Performance: carga con datos mixtos (stress),"Clientes variados, algunos sin historial","Mixture of valid/invalid payloads concurrent","No crashes; error rate documentado; observe tail latency",Crítica,"mix: 80% valid, 10% invalid, 10% malformed; concurrency=100"
