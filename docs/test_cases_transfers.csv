ID,Escenario,Pre-condiciones,Pasos,Validaciones,Resultado Esperado,Datos Prueba
TP-01,"Path feliz: transferencia exitosa dentro de límites","Cuenta origen activa; saldo suficiente; cuenta destino válida; fuera de mantenimiento","1) Iniciar sesión; 2) Ingresar cuenta destino y monto $1,000; 3) Confirmar transferencia; 4) Verificar resumen","200 OK; débito origen; crédito destino; registro en historial; notificación","Transferencia completada; saldos actualizados","origen:A-1001 saldo:10000; destino:B-2001; monto:1000"
TP-02,"Exceder límite diario","Cuenta origen activa; consumo diario previo: $49,500","Intentar transferir $1,000","403/422; mensaje 'Límite diario excedido'; sin débito","Transferencia rechazada por límite diario","origen:A-1002 saldo:5000; consumo_diario:49500; monto:1000"
TP-03,"Exceder límite mensual","Cuenta origen activa; consumo mensual previo cercano a $5,000,000","Intentar transferencia que supere el tope mensual","403/422; mensaje 'Límite mensual excedido'; sin débito","Transferencia bloqueada por límite mensual","origen:A-1003 saldo:1000000; consumo_mensual:4900000; monto:200001"
TP-04,"Saldo insuficiente","Cuenta origen activa; saldo $500","Intentar transferir $1,000","402/400; mensaje 'Saldo insuficiente'; sin débito","Transferencia rechazada; saldos sin cambios","origen:A-1004 saldo:500; destino:B-2004; monto:1000"
TP-05,"OTP inválido para montos altos","Transferencia > $1,000,000; OTP obligatorio","Iniciar transferencia $1,500,000; ingresar OTP inválido","401/403; mensaje 'OTP inválido'; operación no aplicada","Transferencia rechazada por OTP inválido","origen:A-1005 saldo:2000000; monto:1500000; OTP:000000"
TP-06,"Transferencia en horario de mantenimiento","Hora simulada 01:30 (mantenimiento 01:00-03:00)","Intentar transferencia $100","503/409; mensaje 'Mantenimiento'; sin débito","Transferencia no procesada por mantenimiento","origen:A-1006 saldo:5000; destino:B-2006; hora:01:30"
TP-07,"Cuenta destino inválida o inexistente","Cuenta destino no existe o formato inválido","Intentar transferencia a cuenta inválida","400/404; mensaje 'Cuenta destino no encontrada'; sin débito","Rechazo; fondos no se mueven","origen:A-1007 saldo:5000; destino:Z-9999(no existe); monto:100"
TP-08,"Edge case: transferencia mínima $0.01","Cuenta con saldo >= $0.01","Transferir $0.01","200 OK (si permitido) o 400 si hay regla mínima; comprobar precisión y redondeo","Si se aceptan centavos, movimiento creado; si no, error de validación","origen:A-1008 saldo:1.00; destino:B-2008; monto:0.01"
TP-09,"Edge case: monto negativo","Cuenta origen activa","Enviar transferencia con monto -$100","400 Bad Request; validación de monto positivo","Rechazo por validación; sin cambios","origen:A-1009 saldo:1000; destino:B-2009; monto:-100"
TP-10,"Edge case: decimales excesivos","Cuenta origen activa","Transferir monto con >2 decimales (100.1234)","400 Bad Request o normalización; validar cómo se redondea","Rechazo o normalización documentada","origen:A-1010 saldo:1000; destino:B-2010; monto:100.1234"
TP-11,"Concurrencia: 2 transferencias simultáneas agotando saldo","Origen saldo $1,000; dos transfers paralelas de $600","Lanzar 2 transferencias en paralelo","Control de concurrencia/lock: sólo una pasa; la otra falla por saldo insuficiente","Resultado: 1 exitosa, 1 rechazada; saldos consistentes","origen:A-1011 saldo:1000; destino1:B-2011 monto:600; destino2:B-2012 monto:600"
TP-12,"Cuenta bloqueada","Cuenta origen en estado BLOQUEADA","Intentar transferencia $100","403 Forbidden; mensaje 'Cuenta bloqueada'; sin débito","Transferencia rechazada","origen:A-1012 estado:BLOQUEADA; destino:B-2012; monto:100"
TP-13,"Cuenta origen == cuenta destino","Cuenta origen activa","Intentar transferir $100 a la misma cuenta","400 Bad Request; mensaje 'Cuenta origen y destino iguales'","Rechazo por validación","origen/destino:A-1013; monto:100"
TP-14,"Límite al borde diario","Consumo diario previo $49,000; saldo suficiente","Transferir $1,000","200 OK; consumo diario ahora $50,000; siguiente intento falla","Transferencia permitida; límite consumido","origen:A-1014 saldo:2000; consumo_diario_prev:49000; monto:1000"
TP-15,"Reintento idempotente tras fallo parcial","Cuenta activa; simular timeout después de débito pero antes de confirmación","Ejecutar transferencia; simular timeout; reintentar con misma idempotency key","Sistema detecta duplicado; sólo un débito; idempotencia respetada","Al reintentar con misma clave, no se duplica el débito","origen:A-1015 saldo:5000; destino:B-2015; monto:500; idempotency-key:abc-123"